---
title: è‡ªç ”! å¹³å‡O(m+n)çš„å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•
date: 2024-11-02 22:44:00
categories: [åšå®¢, ç®—æ³•]
tags: [Cè¯­è¨€, ç®—æ³•]
excerpt: è°èƒ½æ‹’ç»ä¸€ä¸ªå†™æ³•æ¯”KMPç®€å•ï¼Œæ—¶é—´å¤æ‚åº¦æ‘¸æ‘¸KMPï¼Œç©ºé—´å¤æ‚åº¦å¤§æ¦‚æŒå¹³KMPçš„å¯å¯çˆ±çˆ±çš„KeBFå‘¢ğŸ˜˜
math: true
---

# KeBFç®—æ³•

## æˆ‘æ„¿ç§°ä¹‹KeBFç®—æ³•
>
>Keçš„BF(Brute Forceï¼Œæš´åŠ›æ£€ç´¢)æ³•
>
>å…³äºå…¶ä»– __[å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•](https://blog.csdn.net/paincupid/article/details/81159320)__
>
### ç¤ºä¾‹æºç 

```c
#include <stdio.h>
#include <string.h>

int main()
{
    // è¯»å…¥ä¸¤ä¸ªå­—ç¬¦ä¸²
    char ms[100], ps[100];
    fgets(ms, sizeof(ms), stdin);
    fgets(ps, sizeof(ps), stdin);

    // å»æ‰æ¢è¡Œç¬¦
    ms[strcspn(ms, "\n")] = '\0';
    ps[strcspn(ps, "\n")] = '\0';

    int j = 0, index[100];
    int msL = strlen(ms);
    int psL = strlen(ps);
    // ç®—æ³•å®ç°
    for (int i = 0; i <= msL - psL; )
    {
        if ((msL - i) < psL)
            break;
        int t = 0;
        while (t < psL && ms[i + t] == ps[t])
            t++;
        if (t == psL)
            index[j++] = i;
        i += (t > 0) ? t : 1;
    }
    // è¾“å‡ºç»“æœ
    if (j > 0)
        for (int i = 0; i < j; i++)
            printf("%d ", index[i]);
    else
        printf("None");
    printf("\n");

    return 0;
}
```

### ä¸FittenCodeçš„æ–—å¿—æ–—å‹‡

![](/img/blog/2024/11/02/01/01.png)

![](/img/blog/2024/11/02/01/02.png)

![](/img/blog/2024/11/02/01/03.png)

![](/img/blog/2024/11/02/01/04.png)

![](/img/blog/2024/11/02/01/05.png)

__å¤§èƒœåˆ©ï¼__

### æ‰€ä»¥â€”â€”

è°èƒ½æ‹’ç»ä¸€ä¸ªå†™æ³•æ¯”KMPç®€å•ï¼Œæ—¶é—´å¤æ‚åº¦æ‘¸æ‘¸KMP(`O(n)` & `O(m+n)`)ï¼Œç©ºé—´å¤æ‚åº¦å¤§æ¦‚æŒå¹³KMPçš„å¯å¯çˆ±çˆ±çš„KeBFå‘¢ğŸ˜˜

### é™„ KMP ç¤ºä¾‹æºç 
>
>åˆ«é—®ï¼Œé—®å°±æ˜¯fittenCodeå†™çš„ï¼ˆï¼‰

```c
#include <stdio.h>
#include <string.h>

// å‡½æ•°å£°æ˜
void computeNext(const char *pattern, int *next);
void kmpSearch(const char *text, const char *pattern);

int main() {
    char text[100];
    char pattern[100];

    // è¾“å…¥ä¸»ä¸²å’Œæ¨¡å¼ä¸²
    printf("è¯·è¾“å…¥ä¸»ä¸²: ");
    fgets(text, sizeof(text), stdin);
    printf("è¯·è¾“å…¥æ¨¡å¼ä¸²: ");
    fgets(pattern, sizeof(pattern), stdin);

    // å»æ‰æ¢è¡Œç¬¦
    text[strcspn(text, "\n")] = '\0';
    pattern[strcspn(pattern, "\n")] = '\0';

    // è°ƒç”¨ KMP æŸ¥æ‰¾å‡½æ•°
    kmpSearch(text, pattern);

    return 0;
}

// è®¡ç®—æ¨¡å¼ä¸²çš„ next æ•°ç»„
void computeNext(const char *pattern, int *next) {
    int m = strlen(pattern);
    next[0] = 0; // next[0] æ˜¯å§‹ç»ˆä¸º 0

    int j = 0; // j ä»£è¡¨å‰ç¼€é•¿åº¦
    for (int i = 1; i < m; i++) {
        while (j > 0 && pattern[i] != pattern[j]) {
            j = next[j - 1]; // å›æº¯åˆ°å‰ä¸€ä¸ªæœ€ä½³åŒ¹é…
        }
        if (pattern[i] == pattern[j]) {
            j++; // åŒ¹é…ç»§ç»­
        }
        next[i] = j; // è®°å½•å½“å‰å­—ç¬¦åŒ¹é…çš„å‰ç¼€é•¿åº¦
    }
}

// KMP å­—ç¬¦ä¸²æŸ¥æ‰¾
void kmpSearch(const char *text, const char *pattern) {
    int n = strlen(text);
    int m = strlen(pattern);
    int next[m];

    // è®¡ç®—æ¨¡å¼ä¸²çš„ next æ•°ç»„
    computeNext(pattern, next);

    int j = 0; // j ä»£è¡¨å½“å‰åŒ¹é…çš„æ¨¡å¼ä¸²ä¸­çš„ä½ç½®
    for (int i = 0; i < n; i++) {
        while (j > 0 && text[i] != pattern[j]) {
            j = next[j - 1]; // å‘ç”Ÿä¸åŒ¹é…ï¼Œå›æº¯åˆ°å‰ä¸€ä¸ªæœ€ä½³åŒ¹é…
        }
        if (text[i] == pattern[j]) {
            j++; // å­—ç¬¦åŒ¹é…ï¼Œç§»åŠ¨åˆ°æ¨¡å¼ä¸²çš„ä¸‹ä¸€ä¸ªä½ç½®
        }
        if (j == m) {
            printf("æ‰¾åˆ°åŒ¹é…ï¼Œèµ·å§‹ä½ç½®: %d\n", i - m + 1); // æ‰¾åˆ°åŒ¹é…ï¼Œè¾“å‡ºèµ·å§‹ä½ç½®
            j = next[j - 1]; // å‡†å¤‡è¿›è¡Œä¸‹ä¸€ä¸ªåŒ¹é…
        }
    }
}
```

<br><br><br>
$$ \_\_EOF\_\_ $$
<br>
